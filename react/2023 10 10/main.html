<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Quiz App</title>
    <script
      crossorigin
      src="https://unpkg.com/react@17/umd/react.production.min.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"
    ></script>
    <script src="https://unpkg.com/babel-standalone@6.26.0/babel.js"></script>
  </head>
  <body>
    <div class="root"></div>
    <script type="text/babel">
      const { useState } = React;

      const Main = () => {
        const questions = [
          {
            sno: "1",
            ques: "Which of these is not a data type in JavaScript?",
            section: ["Data Types"],
            options: ["String", "Floating Point Number", "Array", "Boolean"],
            ans: "Floating Point Number",
            qtype: "scq",
          },
          {
            sno: "2",
            ques: `What will be the output of the following code?
          let x = 5
          let y = 10
          console.log(x++)
          console.log(x + y)`,
            section: ["Operators", "Code Evaluation"],
            options: ["5 and 15", "6 and 15", "5 and 16", "6 and 16"],
            ans: "5 and 16",
            qtype: "scq",
          },
          {
            sno: "3",
            ques: "Which of these expressions return true?",
            section: ["Data Types"],
            options: [
              "5 == 5.0",
              'new String("John") == "John"',
              'new String("John") == new String("John")',
              'parseInt("5") === parseFloat("5.0")',
            ],
            ans: [
              "5 == 5.0",
              'new String("John") == "John"',
              'parseInt("5") === parseFloat("5.0")',
            ],
            qtype: "mcq",
          },

          {
            sno: "4",
            ques: `Select the data types that are used in the following code:
                      let length = 16;
                      let lastName = "Johnson";
                      const x = {
                      firstName: "John",
                      lastName: "Doe"
                      };`,
            section: ["Data Types", "Code Evaluation"],
            options: ["Boolean", "Array", "String", "Number", "Object"],
            ans: ["String", "Number", "Object"],
            qtype: "mcq",
          },
          {
            sno: "5",
            ques: "Which of these is not a direct use case of length property of an array?",
            section: ["Array"],
            options: [
              "To get the number of elements in the array.",
              "To get the last element of the array.",
              "To execute a function for each element of an array.",
            ],
            ans: "To execute a function for each element of an array.",
            qtype: "scq",
          },
        ];

        //  console.log(questions);
        const [currentQues, setCurrentQues] = useState(1);
        const [showScore, SetShowScore] = useState(false);
        const [finalScore, setFinalScore] = useState(0);
        const [answersCheckBox, setAnswersCheckBox] = useState([]);
        const [answersRadio, setAnswersRadio] = useState("");

        /// handle the options
        const handleChange = (e) => {
          const quary = e.target.value;
          if (e.target.type === "checkbox") {
            console.log("i am in checked");
            if (e.target.checked) {
              console.log(e);
              setAnswersCheckBox([...answersCheckBox, e.target.value]);
            } else {
              let updatedList = [...answersCheckBox];
              updatedList = updatedList.filter((item) => {
                return item !== quary;
              });
              setAnswersCheckBox(updatedList);
            }
          }
          if (e.target.type === "radio") {
            setAnswersRadio(e.target.value);
          }
        };
        // End of the handleChange
        console.log(answersRadio);
        console.log(answersCheckBox);

        // for the next btn
        const handleClickNext = () => {
          if (currentQues === questions.length - 1) {
            SetShowScore(true);
          } else {
            if (questions[currentQues].qtype === "mcq") {
              handleResult(answersCheckBox);
              setAnswersCheckBox([]);
            } else {
              handleResult(answersRadio);
              setAnswersRadio("");
            }
            setCurrentQues(currentQues + 1);
          }
        };
        // for the prev btn
        const handleClickPrev = () => {
          if (currentQues > -1) {
            setCurrentQues(currentQues - 1);
          }
        };

        // check ans and update score
        const handleResult = (answer) => {
          console.log(questions[currentQues].qtype);
          const queType = questions[currentQues].qtype;
          if (queType === "scq") {
            if (questions[currentQues].ans === answer) {
              console.log("right");
              setFinalScore(finalScore + 1);
            } else {
              console.log("wrong");
            }
          }
          if (queType == "mcq") {
            if (
              JSON.stringify(answer.sort()) ===
              JSON.stringify(questions[currentQues].ans.sort())
            ) {
              console.log("sahi h ");
              setFinalScore(finalScore + 1);
              console.log(JSON.stringify(answer.sort()));
            } else {
              console.log("galat h");
              console.log(JSON.stringify(answer.sort()));
            }
          }
        };
        // handle submit btn
        const handleSubmit = () => {};

        //return statement
        return showScore || currentQues < 0 ? (
          <div>{finalScore}</div>
        ) : (
          <div>
            <div className="App-header">
              <div className="">{questions[currentQues].ques}</div>
              <div>{currentQues}</div>
              <div className="option">
                {questions[currentQues].options.map((option) => {
                  // console.log(option);
                  return (
                    <div>
                      <input
                        onChange={(e) => {
                          handleChange(e);
                        }}
                        name="action"
                        type={
                          questions[currentQues].qtype === "scq"
                            ? "radio"
                            : "checkbox"
                        }
                        value={option}
                        id={option}
                        /// for exp
                      />
                      <label htmlFor={option}>{option}</label>
                      <br></br>
                    </div>
                  );
                })}
              </div>
              <input type="button" value="next" onClick={handleClickNext} />
              <input type="button" value="prev" onClick={handleClickPrev} />
              <input type="button" value="Submit" onClick={handleSubmit} />
            </div>
          </div>
        );
      };

      ReactDOM.render(<Main />, document.querySelector(".root"));
    </script>
  </body>
</html>
